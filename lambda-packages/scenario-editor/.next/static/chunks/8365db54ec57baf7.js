(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,2484,e=>{"use strict";let t,r;var n=e.i(48836),s=e.i(7527),o=Object.defineProperty,i=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,d=(e,t,r)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f=(e,t)=>{for(var r in t||(t={}))u.call(t,r)&&d(e,r,t[r]);if(l)for(var r of l(t))c.call(t,r)&&d(e,r,t[r]);return e},p=(e,t)=>i(e,a(t)),h=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},m=async(e,t)=>{var r,n,s,o,i,a;let l=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let n=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));l=n.options||l,e=n.url}u.onRequest.push(null==(n=c.hooks)?void 0:n.onRequest),u.onResponse.push(null==(s=c.hooks)?void 0:s.onResponse),u.onSuccess.push(null==(o=c.hooks)?void 0:o.onSuccess),u.onError.push(null==(i=c.hooks)?void 0:i.onError),u.onRetry.push(null==(a=c.hooks)?void 0:a.onRetry)}return{url:e,options:l,hooks:u}},g=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},y=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},v=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let n=r(e.auth.username),s=r(e.auth.password);if(!n||!s)return t;t.authorization=`Basic ${btoa(`${n}:${s}`)}`}else if("Custom"===e.auth.type){let n=r(e.auth.value);if(!n)return t;t.authorization=`${r(e.auth.prefix)} ${n}`}}return t},w=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function b(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function T(e){try{return JSON.parse(e)}catch(t){return e}}function E(e){return"function"==typeof e}async function x(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await v(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=b(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var R=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function j(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new R(r.issues);return r.value}var O=["get","post","put","patch","delete"],S=async(e,t)=>{var r,n,s,o,i,a,l,u;let c,{hooks:d,url:v,options:R}=await m(e,t),A=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&E(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&E(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(R),N=new AbortController,C=null!=(r=R.signal)?r:N.signal,_=function(e,t){let{baseURL:r,params:n,query:s}=t||{query:{},params:{},baseURL:""},o=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];O.includes(t)&&(e=e.replace(`@${t}/`,"/"))}o.endsWith("/")||(o+="/");let[i,a]=e.replace(o,"").split("?"),l=new URLSearchParams(a);for(let[e,t]of Object.entries(s||{}))null!=t&&l.set(e,String(t));if(n)if(Array.isArray(n))for(let[e,t]of i.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];i=i.replace(t,r)}else for(let[e,t]of Object.entries(n))i=i.replace(`:${e}`,String(t));(i=i.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(i=i.slice(1));let u=l.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",o.startsWith("http"))?new URL(`${i}${u}`,o):`${o}${i}${u}`}(v,R),L=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(b(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return e.body}(R),I=await x(R),P=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return O.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(v,R),U=p(f({},R),{url:_,headers:I,body:L,method:P,signal:C});for(let e of d.onRequest)if(e){let t=await e(U);t instanceof Object&&(U=t)}("pipeTo"in U&&"function"==typeof U.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in U)&&(U.duplex="half");let{clearTimeout:$}=(!(null==R?void 0:R.signal)&&(null==R?void 0:R.timeout)&&(c=setTimeout(()=>null==N?void 0:N.abort(),null==R?void 0:R.timeout)),{abortTimeout:c,clearTimeout:()=>{c&&clearTimeout(c)}}),k=await A(U.url,U);$();let M={response:k,request:U};for(let e of d.onResponse)if(e){let r=await e(p(f({},M),{response:(null==(s=null==t?void 0:t.hookOptions)?void 0:s.cloneResponse)?k.clone():k}));r instanceof Response?k=r:r instanceof Object&&(k=r.response)}if(k.ok){if("HEAD"===U.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return w.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}(k),r={data:"",response:k,request:U};if("json"===e||"text"===e){let e=await k.text(),t=null!=(o=U.jsonParser)?o:T;r.data=await t(e)}else r.data=await k[e]();for(let e of((null==U?void 0:U.output)&&U.output&&!U.disableValidation&&(r.data=await j(U.output,r.data)),d.onSuccess))e&&await e(p(f({},r),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?k.clone():k}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let B=null!=(a=null==t?void 0:t.jsonParser)?a:T,D=await k.text(),q=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(D),F=q?await B(D):null,H={response:k,responseText:D,request:U,error:p(f({},F),{status:k.status,statusText:k.statusText})};for(let e of d.onError)e&&await e(p(f({},H),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?k.clone():k}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new g({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new g(e);case"exponential":return new y(e);default:throw Error("Invalid retry strategy")}}(t.retry),n=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(n,k)){for(let e of d.onRetry)e&&await e(M);let s=r.getDelay(n);return await new Promise(e=>setTimeout(e,s)),await S(e,p(f({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new h(k.status,k.statusText,q?F:D);return{data:null,error:p(f({},F),{status:k.status,statusText:k.statusText})}},A=e.i(54002);let N=Object.create(null),C=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?N:globalThis),_=new Proxy(N,{get:(e,t)=>C()[t]??N[t],has:(e,t)=>t in C()||t in N,set:(e,t,r)=>(C(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=C(!0);return delete r[t],!0},ownKeys:()=>Object.keys(C(!0))});function L(e,t){return void 0!==A.default&&A.default.env?A.default.env[e]??t:"undefined"!=typeof Deno?Deno.env.get(e)??t:"undefined"!=typeof Bun?Bun.env[e]??t:t}void 0!==A.default&&A.default.env,Object.freeze({get BETTER_AUTH_SECRET(){return L("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return L("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return L("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return L("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return L("NODE_ENV","development")},get PACKAGE_VERSION(){return L("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return L("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}});let I={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},P=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),U=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],$="\x1b[0m",k="\x1b[31m",M="\x1b[32m",B="\x1b[33m",D="\x1b[34m",q="\x1b[35m",F=["info","success","warn","error","debug"],H={info:D,success:M,warn:B,error:k,debug:q};t=(void 0)??"error",r=1!==function(){if(void 0!==L("FORCE_COLOR"))switch(L("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==L("NODE_DISABLE_COLORS")&&""!==L("NODE_DISABLE_COLORS")||void 0!==L("NO_COLOR")&&""!==L("NO_COLOR")||"dumb"===L("TERM"))return 1;if(L("TMUX"))return 24;if("TF_BUILD"in _&&"AGENT_NAME"in _)return 4;if("CI"in _){for(let{0:e,1:t}of P)if(e in _)return t;return"codeship"===L("CI_NAME")?8:1}if("TEAMCITY_VERSION"in _)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(L("TEAMCITY_VERSION"))?4:1;switch(L("TERM_PROGRAM")){case"iTerm.app":if(!L("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(L("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===L("COLORTERM")||"24bit"===L("COLORTERM"))return 24;if(L("TERM")){if(null!==/truecolor/.exec(L("TERM")))return 24;if(null!==/^xterm-256/.exec(L("TERM")))return 8;let e=L("TERM").toLowerCase();if(I[e])return I[e];if(U.some(t=>null!==t.exec(e)))return 4}return L("COLORTERM")?4:1}(),Object.fromEntries(F.map(e=>[e,(...[n,...s])=>((e,n,s=[])=>{let o;if(!(F.indexOf(e)<=F.indexOf(t)))return;let i=(o=new Date().toISOString(),r?`\x1b[2m${o}${$} ${H[e]}${e.toUpperCase()}${$} \x1b[1m[Better Auth]:${$} ${n}`:`${o} ${e.toUpperCase()} [Better Auth]: ${n}`);"error"===e?console.error(i,...s):"warn"===e?console.warn(i,...s):console.log(i,...s)})(e,n,s)]));class G extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}}function W(e,t="/api/auth"){if(function(e){try{let t=new URL(e).pathname.replace(/\/+$/,"")||"/";return"/"!==t}catch(t){throw new G(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let r=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`):r}let V=[],Y=0,J=0,K=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=Y+4;t<V.length;)V[t]===e?V.splice(t,4):t+=4;let n=t.indexOf(e);~n&&(t.splice(n,1),--r.lc||r.off())}),notify(e,n){J++;let s=!V.length;for(let s of t)V.push(s,r.value,e,n);if(s){for(Y=0;Y<V.length;Y+=4)V[Y](V[Y+1],V[Y+2],V[Y+3]);V.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},z=(e,t)=>{var r,n;return r=r=>{let n=t(r);n&&e.events[6].push(n)},n=t=>{let r=e.listen;e.listen=(...n)=>(e.lc||e.active||(e.active=!0,t()),r(...n));let n=e.off;return e.events[6]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=n}},e.events=e.events||{},e.events[15]||(e.events[15]=n(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],n=t.indexOf(r);t.splice(n,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}},X="undefined"==typeof window,Z={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},Q=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,ee={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},et=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,er={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"undefined"!=typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},en=function(e){var t,r;let{pluginPathMethods:n,pluginsActions:o,pluginsAtoms:i,$fetch:a,$store:l,atomListeners:u}=((e,t)=>{var r;let n,s="credentials"in Request.prototype,o=function(e,t,r,n){if(e)return W(e,t);if(!1!==n){let e=_.BETTER_AUTH_URL||_.NEXT_PUBLIC_BETTER_AUTH_URL||_.PUBLIC_BETTER_AUTH_URL||_.NUXT_PUBLIC_BETTER_AUTH_URL||_.NUXT_PUBLIC_AUTH_URL||("/"!==_.BASE_URL?_.BASE_URL:void 0);if(e)return W(e,t)}let s=r?.headers.get("x-forwarded-host"),o=r?.headers.get("x-forwarded-proto");if(s&&o)return W(`${o}://${s}`,t);if(r){let e=function(e){try{return new URL(e).origin}catch(e){return null}}(r.url);if(!e)throw new G("Could not get origin from request. Please provide a valid base URL.");return W(e,t)}if("undefined"!=typeof window&&window.location)return W(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,void 0)??"/api/auth",i=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],a={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:l,onError:u,onRequest:c,onResponse:d,...h}=e?.fetchOptions||{},m=(r={baseURL:o,...s?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:s,parseDates:o=!0}=t;if("string"!=typeof e)return e;let i=e.trim();if(i.length>0&&'"'===i[0]&&i.endsWith('"')&&!i.slice(1,-1).includes('"'))return i.slice(1,-1);let a=i.toLowerCase();if(a.length<=9&&a in ee)return ee[a];if(!Q.test(i)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(Z).some(([e,t])=>{let r=t.test(i);return r&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(i,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){n&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(o&&"string"==typeof t){let e=function(e){let t=et.exec(e);if(!t)return null;let[,r,n,s,o,i,a,l,u,c,d]=t,f=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(s,10),parseInt(o,10),parseInt(i,10),parseInt(a,10),l?parseInt(l.padEnd(3,"0"),10):0));if(u){let e=(60*parseInt(c,10)+parseInt(d,10))*("+"===u?-1:1);f.setUTCMinutes(f.getUTCMinutes()+e)}return f instanceof Date&&!isNaN(f.getTime())?f:null}(t);if(e)return e}return s?s(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...h,plugins:[a,...h.plugins||[],...e?.disableDefaultFetchPlugins?[]:[er],...i]},async function(e,t){let n,s=p(f(f({},r),t),{plugins:[...(null==r?void 0:r.plugins)||[],(n=r||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,s,o,i;let a=(null==(s=null==(r=n.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:s.schema)||n.schema;if(a){let r=e;(null==(o=a.config)?void 0:o.prefix)&&r.startsWith(a.config.prefix)&&(r=r.replace(a.config.prefix,""),a.config.baseURL&&(e=e.replace(a.config.prefix,a.config.baseURL))),(null==(i=a.config)?void 0:i.baseURL)&&r.startsWith(a.config.baseURL)&&(r=r.replace(a.config.baseURL,""));let n=a.schema[r];if(n){let r=p(f({},t),{method:n.method,output:n.output});return(null==t?void 0:t.disableValidation)||(r=p(f({},r),{body:n.input?await j(n.input,null==t?void 0:t.body):null==t?void 0:t.body,params:n.params?await j(n.params,null==t?void 0:t.params):null==t?void 0:t.params,query:n.query?await j(n.query,null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}})]});if(null==r?void 0:r.catchAllError)try{return await S(e,s)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await S(e,s)}),{$sessionSignal:g,session:y}={session:((e,t,r,n)=>{let s=K({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>o(e)}),o=e=>{let o="function"==typeof n?n({data:s.get().data,error:s.get().error,isPending:s.get().isPending}):n;r(t,{...o,query:{...o?.query,...e?.query},async onSuccess(e){s.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch}),await o?.onSuccess?.(e)},async onError(e){let{request:t}=e,r="number"==typeof t.retry?t.retry:t.retry?.attempts,n=t.retryAttempt||0;r&&n<r||(s.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch}),await o?.onError?.(e))},async onRequest(e){let t=s.get();s.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:s.value.refetch}),await o?.onRequest?.(e)}}).catch(e=>{s.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:s.value.refetch})})};e=Array.isArray(e)?e:[e];let i=!1;for(let t of e)t.subscribe(()=>{X||(i?o():z(s,()=>{let e=setTimeout(()=>{i||(o(),i=!0)},0);return()=>{s.off(),t.off(),clearTimeout(e)}}))});return s})(n=K(!1),"/get-session",m,{method:"GET"}),$sessionSignal:n},v=e?.plugins||[],w={},b={$sessionSignal:g,session:y},T={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},E=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||e.startsWith("/sign-in")||e.startsWith("/sign-up")||"/delete-user"===e||"/verify-email"===e}];for(let e of v)e.getAtoms&&Object.assign(b,e.getAtoms?.(m)),e.pathMethods&&Object.assign(T,e.pathMethods),e.atomListeners&&E.push(...e.atomListeners);let x={notify:e=>{b[e].set(!b[e].get())},listen:(e,t)=>{b[e].subscribe(t)},atoms:b};for(let t of v)t.getActions&&Object.assign(w,t.getActions?.(m,x,e));return{get baseURL(){return o},pluginsActions:w,pluginsAtoms:b,pluginPathMethods:T,atomListeners:E,$fetch:m,$store:x}})(e),c={};for(let[e,t]of Object.entries(i)){c[`use${(r=e).charAt(0).toUpperCase()+r.slice(1)}`]=()=>(function(e,t={}){let r=(0,s.useRef)(e.get()),{keys:n,deps:o=[e,n]}=t,i=(0,s.useCallback)(t=>{let s=e=>{r.current!==e&&(r.current=e,t())};if(s(e.value),n?.length){let t;return t=new Set(n).add(void 0),e.listen((e,r,n)=>{t.has(n)&&s(e,r,n)})}return e.listen(s)},o),a=()=>r.current;return(0,s.useSyncExternalStore)(i,a,a)})(t)}return t={...o,...c,$fetch:a,$store:l},function e(r=[]){return new Proxy(function(){},{get(n,s){var o;if("string"!=typeof s||"then"===s||"catch"===s||"finally"===s)return;let i=[...r,s],a=t;for(let e of i)if(a&&"object"==typeof a&&e in a)a=a[e];else{a=void 0;break}return"function"==typeof a?a:"object"==typeof(o=a)&&null!==o&&"get"in o&&"function"==typeof o.get&&"lc"in o&&"number"==typeof o.lc?a:e(i)},apply:async(e,t,s)=>{let o="/"+r.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),l=s[0]||{},c=s[1]||{},{query:d,fetchOptions:f,...p}=l,h={...c,...f},m=function(e,t,r){let n=t[e],{fetchOptions:s,query:o,...i}=r||{};return n||(s?.method?s.method:i&&Object.keys(i).length>0?"POST":"GET")}(o,n,l);return await a(o,{...h,body:"GET"===m?void 0:{...p,...h?.body||{}},query:d||h?.query,method:m,async onSuccess(e){if(await h?.onSuccess?.(e),!u)return;let t=u.filter(e=>e.matcher(o));if(t.length)for(let e of t){let t=i[e.signal];if(!t)return;let r=t.get();setTimeout(()=>{t.set(!r)},10)}}})}})}()}({baseURL:window.location.origin});function es(){let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=async()=>{try{let e=await en.getSession(),r=e&&"object"==typeof e&&"data"in e?e.data:e;t(r),n(!1)}catch(e){console.error("[Better Auth Client] Session error:",e),t(null),n(!1)}};e();let r=setTimeout(e,1e3),s=()=>{document.hidden||e()};return document.addEventListener("visibilitychange",s),()=>{clearTimeout(r),document.removeEventListener("visibilitychange",s)}},[]),{user:e?.user?{userId:e.user.id||"",username:e.user.name||e.user.email||"",email:e.user.email}:null,isLoading:r,isAuthenticated:!!e?.user,session:e}}async function eo(e){await en.signIn.social({provider:"cognito",callbackURL:e||window.location.origin+window.location.pathname})}async function ei(){try{await en.signOut(),window.location.href=window.location.origin}catch(e){console.error("[Better Auth Client] Logout error:",e),window.location.href=window.location.origin}}function ea(){let{user:e,isLoading:t}=es();return(0,n.jsxs)("header",{children:[(0,n.jsx)("h1",{children:"Scenario Editor"}),(0,n.jsx)("div",{className:"auth-status",children:t?(0,n.jsx)("span",{children:"Checking..."}):e?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{children:["Logged in as ",e.email||e.username]}),(0,n.jsx)("button",{className:"btn btn-secondary",onClick:function(){ei()},children:"Logout"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"Not logged in"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:function(){eo(window.location.href)},children:"Login"})]})})]})}let el={clear:"#e8e8e8",mountain:"#8b7355",forest:"#2d5016",water:"#4a90e2",desert:"#f4a460",swamp:"#556b2f"};function eu({columns:e,rows:t,hexes:r=[],selectedTerrain:o="clear",onHexClick:i}){let a=(0,s.useRef)(null),[l,u]=(0,s.useState)(null);return((0,s.useEffect)(()=>{if(!a.current||0===e||0===t)return;let n=a.current;n.innerHTML="";let s=new Map;r.forEach(e=>{let t=`${e.row},${e.column}`;s.set(t,e)});let o=40*Math.sqrt(3),c=e*o*.75+.375*o,d=80*t*.75;n.setAttribute("viewBox",`0 0 ${c} ${d}`);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=`${r},${t}`,a=s.get(e)||{row:r,column:t,terrain:"clear"},c=t*o*.75+(r%2==1?.375*o:0),d=80*r*.75,f=document.createElementNS("http://www.w3.org/2000/svg","g");f.setAttribute("class","hex-group"),f.setAttribute("data-row",r.toString()),f.setAttribute("data-column",t.toString());let p=[];for(let e=0;e<6;e++){let t=Math.PI/3*e,r=c+40+40*Math.cos(t),n=d+40+40*Math.sin(t);p.push(`${r},${n}`)}let h=document.createElementNS("http://www.w3.org/2000/svg","polygon");h.setAttribute("points",p.join(" ")),h.setAttribute("fill",el[a.terrain]||el.clear),h.setAttribute("stroke","#333"),h.setAttribute("stroke-width","1"),h.setAttribute("class","hex-polygon"),h.style.cursor="pointer",h.addEventListener("mouseenter",()=>{h.setAttribute("stroke-width","2"),h.setAttribute("stroke","#3498db")}),h.addEventListener("mouseleave",()=>{h.setAttribute("stroke-width","1"),h.setAttribute("stroke","#333")}),h.addEventListener("click",()=>{u({row:r,column:t}),i&&i(r,t)}),l&&l.row===r&&l.column===t&&(h.setAttribute("stroke-width","3"),h.setAttribute("stroke","#e74c3c")),f.appendChild(h),n.appendChild(f)}},[e,t,r,o,l,i]),0===e||0===t)?(0,n.jsx)("div",{className:"hex-grid-container",children:(0,n.jsx)("p",{className:"info-message",children:"Set columns and rows to create a grid"})}):(0,n.jsx)("div",{className:"hex-grid-container",children:(0,n.jsx)("svg",{ref:a,className:"hex-grid-svg",preserveAspectRatio:"xMidYMid meet"})})}async function ec(){try{let e=await fetch("/api/auth/get-session",{credentials:"include",cache:"no-store"});if(e.ok){let t=await e.json(),r=t?.data||t;return r?.session?.idToken||r?.idToken||null}return null}catch(e){return console.error("[API Client] Error getting access token:",e),null}}async function ed(e,t,r,n){let s,o=`https://dev.api.syniad.net${t}`,i={};r&&(i["Content-Type"]="application/json");let a=n||await ec();a&&(i.Authorization=`Bearer ${a}`);let l={method:e,headers:i,credentials:"include",cache:"no-store"};r&&(l.body=JSON.stringify(r));try{s=await fetch(o,l)}catch(e){throw console.error("[API Client] Fetch error:",e),Error(`Network error: ${e.message||"Failed to fetch"}`)}if(!s.ok){let e=await s.json().catch(()=>({error:"Unknown error"}));throw console.error("[API Client] API error:",{status:s.status,statusText:s.statusText,error:e,url:o,hasToken:!!a}),Error(e.error||`API request failed: ${s.status} ${s.statusText}`)}return await s.json()}async function ef(e=100,t,r){let n=`/scenarios?limit=${e}`;return t&&(n+=`&nextToken=${encodeURIComponent(t)}`),await ed("GET",n,void 0,r)}async function ep(e,t){return await ed("GET",`/scenarios/${e}`,void 0,t)}async function eh(e,t){return await ed("POST","/scenarios",e,t)}async function em(e,t,r){return await ed("PUT",`/scenarios/${e}`,t,r)}async function eg(e,t){return await ed("DELETE",`/scenarios/${e}`,void 0,t)}let ey=["clear","mountain","forest","water","desert","swamp"];function ev(){let{isAuthenticated:e}=es(),[t,r]=(0,s.useState)([]),[o,i]=(0,s.useState)(null),[a,l]=(0,s.useState)("clear"),[u,c]=(0,s.useState)(!1),[d,f]=(0,s.useState)(null),[p,h]=(0,s.useState)(""),[m,g]=(0,s.useState)(""),[y,v]=(0,s.useState)(12),[w,b]=(0,s.useState)(10),[T,E]=(0,s.useState)(15),[x,R]=(0,s.useState)(!1),[j,O]=(0,s.useState)([]);function S(e,t){f({text:e,type:t}),setTimeout(()=>f(null),5e3)}async function A(){if(!e)return void S("Please login to view scenarios","error");try{c(!0);let e=await ef();r(e.scenarios||[])}catch(e){S(`Error loading scenarios: ${e.message}`,"error")}finally{c(!1)}}async function N(t){if(!e)return void S("Please login to load scenarios","error");try{c(!0);let e=(await ep(t)).scenario;i(e),h(e.title),g(e.description),v(e.columns),b(e.rows),E(e.turns),O(e.hexes||[]),R(!0),S("Scenario loaded","success")}catch(e){S(`Error loading scenario: ${e.message}`,"error")}finally{c(!1)}}function C(){i(null),h(""),g(""),v(12),b(10),E(15),O([]),R(!1)}async function _(){if(!e)return void S("Please login to save scenarios","error");if(!p.trim())return void S("Please enter a title","error");try{c(!0);let e={title:p.trim(),description:m.trim(),columns:y,rows:w,turns:T,hexes:j};if(o)await em(o.scenarioId,e),S("Scenario updated successfully","success"),await A();else{let t=await eh(e);i(t.scenario),R(!0),S("Scenario created successfully","success"),await A()}}catch(e){S(`Error saving scenario: ${e.message}`,"error")}finally{c(!1)}}async function L(){if(o&&confirm("Are you sure you want to delete this scenario?")){if(!e)return void S("Please login to delete scenarios","error");try{c(!0),await eg(o.scenarioId),S("Scenario deleted successfully","success"),C(),await A()}catch(e){S(`Error deleting scenario: ${e.message}`,"error")}finally{c(!1)}}}return(0,s.useEffect)(()=>{e&&A()},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ea,{}),(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("aside",{className:"sidebar",children:[(0,n.jsxs)("section",{className:"scenario-list-section",children:[(0,n.jsx)("h2",{children:"Scenarios"}),(0,n.jsx)("button",{className:"btn btn-small",onClick:A,children:"Refresh"}),(0,n.jsx)("div",{className:"scenario-list",children:u?(0,n.jsx)("p",{className:"loading",children:"Loading scenarios..."}):0===t.length?(0,n.jsx)("p",{className:"empty-message",children:"No scenarios found"}):t.map(e=>(0,n.jsxs)("div",{className:"scenario-item",children:[(0,n.jsx)("h3",{children:e.title}),(0,n.jsxs)("p",{children:[e.columns,"Ã—",e.rows,", ",e.turns," turns"]}),(0,n.jsx)("button",{className:"btn btn-small",onClick:()=>N(e.scenarioId),children:"Load"})]},e.scenarioId))})]}),(0,n.jsxs)("section",{className:"scenario-form-section",children:[(0,n.jsx)("h2",{children:x?"Edit Scenario":"Create New Scenario"}),(0,n.jsxs)("form",{children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"scenario-title",children:"Title"}),(0,n.jsx)("input",{type:"text",id:"scenario-title",value:p,onChange:e=>h(e.target.value),required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"scenario-description",children:"Description"}),(0,n.jsx)("textarea",{id:"scenario-description",value:m,onChange:e=>g(e.target.value),rows:3})]}),(0,n.jsxs)("div",{className:"form-row",children:[(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"scenario-columns",children:"Columns"}),(0,n.jsx)("input",{type:"number",id:"scenario-columns",value:y,onChange:e=>v(parseInt(e.target.value)||12),min:1,disabled:x,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"scenario-rows",children:"Rows"}),(0,n.jsx)("input",{type:"number",id:"scenario-rows",value:w,onChange:e=>b(parseInt(e.target.value)||10),min:1,disabled:x,required:!0})]}),(0,n.jsxs)("div",{className:"form-group",children:[(0,n.jsx)("label",{htmlFor:"scenario-turns",children:"Turns"}),(0,n.jsx)("input",{type:"number",id:"scenario-turns",value:T,onChange:e=>E(parseInt(e.target.value)||15),min:1,disabled:x,required:!0})]})]}),(0,n.jsx)("div",{className:"form-actions",children:x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{type:"button",className:"btn btn-success",onClick:_,children:"Save Changes"}),(0,n.jsx)("button",{type:"button",className:"btn btn-danger",onClick:L,children:"Delete"}),(0,n.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:C,children:"Cancel"})]}):(0,n.jsx)("button",{type:"button",className:"btn btn-primary",onClick:C,children:"Create New"})})]})]}),(0,n.jsxs)("section",{className:"terrain-selector-section",children:[(0,n.jsx)("h2",{children:"Terrain Type"}),(0,n.jsx)("div",{className:"terrain-selector",children:ey.map(e=>(0,n.jsx)("button",{className:`terrain-btn ${a===e?"active":""}`,onClick:()=>l(e),title:e.charAt(0).toUpperCase()+e.slice(1),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,n.jsxs)("p",{className:"selected-terrain",children:["Selected: ",(0,n.jsx)("span",{children:a})]})]})]}),(0,n.jsx)("main",{className:"main-content",children:(0,n.jsx)(eu,{columns:y,rows:w,hexes:j,selectedTerrain:a,onHexClick:function(e,t){if(!x&&!o)return;let r=j.findIndex(r=>r.row===e&&r.column===t),n={row:e,column:t,terrain:a};if(r>=0){let e=[...j];e[r]=n,O(e)}else O([...j,n])}})})]}),u&&(0,n.jsxs)("div",{className:"loading-overlay",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("p",{children:"Loading..."})]}),d&&(0,n.jsx)("div",{className:"message-container",children:(0,n.jsx)("div",{className:`message message-${d.type}`,children:d.text})})]})}e.s(["default",()=>ev],2484)}]);