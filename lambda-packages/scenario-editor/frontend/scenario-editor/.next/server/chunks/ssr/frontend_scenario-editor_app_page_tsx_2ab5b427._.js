module.exports=[49619,a=>{"use strict";let b,c;var d=a.i(86713),e=a.i(48841),f=Object.defineProperty,g=Object.defineProperties,h=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,l=(a,b,c)=>b in a?f(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,m=(a,b)=>{for(var c in b||(b={}))j.call(b,c)&&l(a,c,b[c]);if(i)for(var c of i(b))k.call(b,c)&&l(a,c,b[c]);return a},n=(a,b)=>g(a,h(b)),o=class extends Error{constructor(a,b,c){super(b||a.toString(),{cause:c}),this.status=a,this.statusText=b,this.error=c}},p=async(a,b)=>{var c,d,e,f,g,h;let i=b||{},j={onRequest:[null==b?void 0:b.onRequest],onResponse:[null==b?void 0:b.onResponse],onSuccess:[null==b?void 0:b.onSuccess],onError:[null==b?void 0:b.onError],onRetry:[null==b?void 0:b.onRetry]};if(!b||!(null==b?void 0:b.plugins))return{url:a,options:i,hooks:j};for(let k of(null==b?void 0:b.plugins)||[]){if(k.init){let d=await (null==(c=k.init)?void 0:c.call(k,a.toString(),b));i=d.options||i,a=d.url}j.onRequest.push(null==(d=k.hooks)?void 0:d.onRequest),j.onResponse.push(null==(e=k.hooks)?void 0:e.onResponse),j.onSuccess.push(null==(f=k.hooks)?void 0:f.onSuccess),j.onError.push(null==(g=k.hooks)?void 0:g.onError),j.onRetry.push(null==(h=k.hooks)?void 0:h.onRetry)}return{url:a,options:i,hooks:j}},q=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(){return this.options.delay}},r=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(a){return Math.min(this.options.maxDelay,this.options.baseDelay*2**a)}},s=async a=>{let b={},c=async a=>"function"==typeof a?await a():a;if(null==a?void 0:a.auth){if("Bearer"===a.auth.type){let d=await c(a.auth.token);if(!d)return b;b.authorization=`Bearer ${d}`}else if("Basic"===a.auth.type){let d=c(a.auth.username),e=c(a.auth.password);if(!d||!e)return b;b.authorization=`Basic ${btoa(`${d}:${e}`)}`}else if("Custom"===a.auth.type){let d=c(a.auth.value);if(!d)return b;b.authorization=`${c(a.auth.prefix)} ${d}`}}return b},t=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function u(a){if(void 0===a)return!1;let b=typeof a;return"string"===b||"number"===b||"boolean"===b||null===b||"object"===b&&(!!Array.isArray(a)||!a.buffer&&(a.constructor&&"Object"===a.constructor.name||"function"==typeof a.toJSON))}function v(a){try{return JSON.parse(a)}catch(b){return a}}async function w(a){let b=new Headers(null==a?void 0:a.headers);for(let[c,d]of Object.entries(await s(a)||{}))b.set(c,d);if(!b.has("content-type")){let c=u(null==a?void 0:a.body)?"application/json":null;c&&b.set("content-type",c)}return b}var x=class a extends Error{constructor(b,c){super(c||JSON.stringify(b,null,2)),this.issues=b,Object.setPrototypeOf(this,a.prototype)}};async function y(a,b){let c=await a["~standard"].validate(b);if(c.issues)throw new x(c.issues);return c.value}var z=["get","post","put","patch","delete"],A=async(a,b)=>{var c,d,e,f,g,h,i,j;let k,{hooks:l,url:s,options:x}=await p(a,b),B=function(a){if(null==a?void 0:a.customFetchImpl)return a.customFetchImpl;if("undefined"!=typeof globalThis&&"function"==typeof globalThis.fetch)return globalThis.fetch;throw Error("No fetch implementation found")}(x),C=new AbortController,D=null!=(c=x.signal)?c:C.signal,E=function(a,b){let{baseURL:c,params:d,query:e}=b||{query:{},params:{},baseURL:""},f=a.startsWith("http")?a.split("/").slice(0,3).join("/"):c||"";if(a.startsWith("@")){let b=a.toString().split("@")[1].split("/")[0];z.includes(b)&&(a=a.replace(`@${b}/`,"/"))}f.endsWith("/")||(f+="/");let[g,h]=a.replace(f,"").split("?"),i=new URLSearchParams(h);for(let[a,b]of Object.entries(e||{}))null!=b&&i.set(a,String(b));if(d)if(Array.isArray(d))for(let[a,b]of g.split("/").filter(a=>a.startsWith(":")).entries()){let c=d[a];g=g.replace(b,c)}else for(let[a,b]of Object.entries(d))g=g.replace(`:${a}`,String(b));(g=g.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(g=g.slice(1));let j=i.toString();return(j=j.length>0?`?${j}`.replace(/\+/g,"%20"):"",f.startsWith("http"))?new URL(`${g}${j}`,f):`${f}${g}${j}`}(s,x),F=function(a){if(!(null==a?void 0:a.body))return null;let b=new Headers(null==a?void 0:a.headers);if(u(a.body)&&!b.has("content-type")){for(let[b,c]of Object.entries(null==a?void 0:a.body))c instanceof Date&&(a.body[b]=c.toISOString());return JSON.stringify(a.body)}return a.body}(x),G=await w(x),H=function(a,b){var c;if(null==b?void 0:b.method)return b.method.toUpperCase();if(a.startsWith("@")){let d=null==(c=a.split("@")[1])?void 0:c.split("/")[0];return z.includes(d)?d.toUpperCase():(null==b?void 0:b.body)?"POST":"GET"}return(null==b?void 0:b.body)?"POST":"GET"}(s,x),I=n(m({},x),{url:E,headers:G,body:F,method:H,signal:D});for(let a of l.onRequest)if(a){let b=await a(I);b instanceof Object&&(I=b)}("pipeTo"in I&&"function"==typeof I.pipeTo||"function"==typeof(null==(d=null==b?void 0:b.body)?void 0:d.pipe))&&!("duplex"in I)&&(I.duplex="half");let{clearTimeout:J}=(!(null==x?void 0:x.signal)&&(null==x?void 0:x.timeout)&&(k=setTimeout(()=>null==C?void 0:C.abort(),null==x?void 0:x.timeout)),{abortTimeout:k,clearTimeout:()=>{k&&clearTimeout(k)}}),K=await B(I.url,I);J();let L={response:K,request:I};for(let a of l.onResponse)if(a){let c=await a(n(m({},L),{response:(null==(e=null==b?void 0:b.hookOptions)?void 0:e.cloneResponse)?K.clone():K}));c instanceof Response?K=c:c instanceof Object&&(K=c.response)}if(K.ok){if("HEAD"===I.method)return{data:"",error:null};let a=function(a){let b=a.headers.get("content-type"),c=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!b)return"json";let d=b.split(";").shift()||"";return t.test(d)?"json":c.has(d)||d.startsWith("text/")?"text":"blob"}(K),c={data:"",response:K,request:I};if("json"===a||"text"===a){let a=await K.text(),b=null!=(f=I.jsonParser)?f:v;c.data=await b(a)}else c.data=await K[a]();for(let a of((null==I?void 0:I.output)&&I.output&&!I.disableValidation&&(c.data=await y(I.output,c.data)),l.onSuccess))a&&await a(n(m({},c),{response:(null==(g=null==b?void 0:b.hookOptions)?void 0:g.cloneResponse)?K.clone():K}));return(null==b?void 0:b.throw)?c.data:{data:c.data,error:null}}let M=null!=(h=null==b?void 0:b.jsonParser)?h:v,N=await K.text(),O=function(a){try{return JSON.parse(a),!0}catch(a){return!1}}(N),P=O?await M(N):null,Q={response:K,responseText:N,request:I,error:n(m({},P),{status:K.status,statusText:K.statusText})};for(let a of l.onError)a&&await a(n(m({},Q),{response:(null==(i=null==b?void 0:b.hookOptions)?void 0:i.cloneResponse)?K.clone():K}));if(null==b?void 0:b.retry){let c=function(a){if("number"==typeof a)return new q({type:"linear",attempts:a,delay:1e3});switch(a.type){case"linear":return new q(a);case"exponential":return new r(a);default:throw Error("Invalid retry strategy")}}(b.retry),d=null!=(j=b.retryAttempt)?j:0;if(await c.shouldAttemptRetry(d,K)){for(let a of l.onRetry)a&&await a(L);let e=c.getDelay(d);return await new Promise(a=>setTimeout(a,e)),await A(a,n(m({},b),{retryAttempt:d+1}))}}if(null==b?void 0:b.throw)throw new o(K.status,K.statusText,O?P:N);return{data:null,error:n(m({},P),{status:K.status,statusText:K.statusText})}};let B=Object.create(null),C=a=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(a?B:globalThis),D=new Proxy(B,{get:(a,b)=>C()[b]??B[b],has:(a,b)=>b in C()||b in B,set:(a,b,c)=>(C(!0)[b]=c,!0),deleteProperty(a,b){if(!b)return!1;let c=C(!0);return delete c[b],!0},ownKeys:()=>Object.keys(C(!0))});function E(a,b){return"undefined"!=typeof process&&process.env?process.env[a]??b:"undefined"!=typeof Deno?Deno.env.get(a)??b:"undefined"!=typeof Bun?Bun.env[a]??b:b}"undefined"!=typeof process&&process.env,Object.freeze({get BETTER_AUTH_SECRET(){return E("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return E("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return E("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return E("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return E("NODE_ENV","development")},get PACKAGE_VERSION(){return E("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return E("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}});let F={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},G=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),H=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],I="\x1b[0m",J="\x1b[31m",K="\x1b[32m",L="\x1b[33m",M="\x1b[34m",N="\x1b[35m",O=["info","success","warn","error","debug"],P={info:M,success:K,warn:L,error:J,debug:N};b=(void 0)??"error",c=1!==function(){if(void 0!==E("FORCE_COLOR"))switch(E("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==E("NODE_DISABLE_COLORS")&&""!==E("NODE_DISABLE_COLORS")||void 0!==E("NO_COLOR")&&""!==E("NO_COLOR")||"dumb"===E("TERM"))return 1;if(E("TMUX"))return 24;if("TF_BUILD"in D&&"AGENT_NAME"in D)return 4;if("CI"in D){for(let{0:a,1:b}of G)if(a in D)return b;return"codeship"===E("CI_NAME")?8:1}if("TEAMCITY_VERSION"in D)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(E("TEAMCITY_VERSION"))?4:1;switch(E("TERM_PROGRAM")){case"iTerm.app":if(!E("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(E("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===E("COLORTERM")||"24bit"===E("COLORTERM"))return 24;if(E("TERM")){if(null!==/truecolor/.exec(E("TERM")))return 24;if(null!==/^xterm-256/.exec(E("TERM")))return 8;let a=E("TERM").toLowerCase();if(F[a])return F[a];if(H.some(b=>null!==b.exec(a)))return 4}return E("COLORTERM")?4:1}(),Object.fromEntries(O.map(a=>[a,(...[d,...e])=>((a,d,e=[])=>{let f;if(!(O.indexOf(a)<=O.indexOf(b)))return;let g=(f=new Date().toISOString(),c?`\x1b[2m${f}${I} ${P[a]}${a.toUpperCase()}${I} \x1b[1m[Better Auth]:${I} ${d}`:`${f} ${a.toUpperCase()} [Better Auth]: ${d}`);"error"===a?console.error(g,...e):"warn"===a?console.warn(g,...e):console.log(g,...e)})(a,d,e)]));class Q extends Error{constructor(a,b){super(a),this.name="BetterAuthError",this.message=a,this.cause=b,this.stack=""}}function R(a,b="/api/auth"){if(function(a){try{let b=new URL(a).pathname.replace(/\/+$/,"")||"/";return"/"!==b}catch(b){throw new Q(`Invalid base URL: ${a}. Please provide a valid base URL.`)}}(a))return a;let c=a.replace(/\/+$/,"");return b&&"/"!==b?(b=b.startsWith("/")?b:`/${b}`,`${c}${b}`):c}let S=[],T=0,U=0,V=a=>{let b=[],c={get:()=>(c.lc||c.listen(()=>{})(),c.value),lc:0,listen:a=>(c.lc=b.push(a),()=>{for(let b=T+4;b<S.length;)S[b]===a?S.splice(b,4):b+=4;let d=b.indexOf(a);~d&&(b.splice(d,1),--c.lc||c.off())}),notify(a,d){U++;let e=!S.length;for(let e of b)S.push(e,c.value,a,d);if(e){for(T=0;T<S.length;T+=4)S[T](S[T+1],S[T+2],S[T+3]);S.length=0}},off(){},set(a){let b=c.value;b!==a&&(c.value=a,c.notify(b))},subscribe(a){let b=c.listen(a);return a(c.value),b},value:a};return c},W={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},X=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,Y={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},Z=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,$={id:"redirect",name:"Redirect",hooks:{onSuccess(a){a.data?.url&&a.data?.redirect}}},_=function(a){var b,c;let{pluginPathMethods:d,pluginsActions:f,pluginsAtoms:g,$fetch:h,$store:i,atomListeners:j}=((a,b)=>{var c;let d,e="credentials"in Request.prototype,f=function(a,b,c,d){if(a)return R(a,b);if(!1!==d){let a=D.BETTER_AUTH_URL||D.NEXT_PUBLIC_BETTER_AUTH_URL||D.PUBLIC_BETTER_AUTH_URL||D.NUXT_PUBLIC_BETTER_AUTH_URL||D.NUXT_PUBLIC_AUTH_URL||("/"!==D.BASE_URL?D.BASE_URL:void 0);if(a)return R(a,b)}let e=c?.headers.get("x-forwarded-host"),f=c?.headers.get("x-forwarded-proto");if(e&&f)return R(`${f}://${e}`,b);if(c){let a=function(a){try{return new URL(a).origin}catch(a){return null}}(c.url);if(!a)throw new Q("Could not get origin from request. Please provide a valid base URL.");return R(a,b)}}(a?.baseURL,a?.basePath,void 0,void 0)??"/api/auth",g=a?.plugins?.flatMap(a=>a.fetchPlugins).filter(a=>void 0!==a)||[],h={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:a?.fetchOptions?.onSuccess,onError:a?.fetchOptions?.onError,onRequest:a?.fetchOptions?.onRequest,onResponse:a?.fetchOptions?.onResponse}},{onSuccess:i,onError:j,onRequest:k,onResponse:l,...o}=a?.fetchOptions||{},p=(c={baseURL:f,...e?{credentials:"include"}:{},method:"GET",jsonParser:a=>a?function(a,b={strict:!0}){return function(a,b={}){let{strict:c=!1,warnings:d=!1,reviver:e,parseDates:f=!0}=b;if("string"!=typeof a)return a;let g=a.trim();if(g.length>0&&'"'===g[0]&&g.endsWith('"')&&!g.slice(1,-1).includes('"'))return g.slice(1,-1);let h=g.toLowerCase();if(h.length<=9&&h in Y)return Y[h];if(!X.test(g)){if(c)throw SyntaxError("[better-json] Invalid JSON");return a}if(Object.entries(W).some(([a,b])=>{let c=b.test(g);return c&&d&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${a} pattern`),c})&&c)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(g,(a,b)=>{if("__proto__"===a||"constructor"===a&&b&&"object"==typeof b&&"prototype"in b){d&&console.warn(`[better-json] Dropping "${a}" key to prevent prototype pollution`);return}if(f&&"string"==typeof b){let a=function(a){let b=Z.exec(a);if(!b)return null;let[,c,d,e,f,g,h,i,j,k,l]=b,m=new Date(Date.UTC(parseInt(c,10),parseInt(d,10)-1,parseInt(e,10),parseInt(f,10),parseInt(g,10),parseInt(h,10),i?parseInt(i.padEnd(3,"0"),10):0));if(j){let a=(60*parseInt(k,10)+parseInt(l,10))*("+"===j?-1:1);m.setUTCMinutes(m.getUTCMinutes()+a)}return m instanceof Date&&!isNaN(m.getTime())?m:null}(b);if(a)return a}return e?e(a,b):b})}catch(b){if(c)throw b;return a}}(a,b)}(a,{strict:!1}):null,customFetchImpl:fetch,...o,plugins:[h,...o.plugins||[],...a?.disableDefaultFetchPlugins?[]:[$],...g]},async function(a,b){let d,e=n(m(m({},c),b),{plugins:[...(null==c?void 0:c.plugins)||[],(d=c||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(a,b){var c,e,f,g;let h=(null==(e=null==(c=d.plugins)?void 0:c.find(b=>{var c;return null!=(c=b.schema)&&!!c.config&&(a.startsWith(b.schema.config.baseURL||"")||a.startsWith(b.schema.config.prefix||""))}))?void 0:e.schema)||d.schema;if(h){let c=a;(null==(f=h.config)?void 0:f.prefix)&&c.startsWith(h.config.prefix)&&(c=c.replace(h.config.prefix,""),h.config.baseURL&&(a=a.replace(h.config.prefix,h.config.baseURL))),(null==(g=h.config)?void 0:g.baseURL)&&c.startsWith(h.config.baseURL)&&(c=c.replace(h.config.baseURL,""));let d=h.schema[c];if(d){let c=n(m({},b),{method:d.method,output:d.output});return(null==b?void 0:b.disableValidation)||(c=n(m({},c),{body:d.input?await y(d.input,null==b?void 0:b.body):null==b?void 0:b.body,params:d.params?await y(d.params,null==b?void 0:b.params):null==b?void 0:b.params,query:d.query?await y(d.query,null==b?void 0:b.query):null==b?void 0:b.query})),{url:a,options:c}}}return{url:a,options:b}}})]});if(null==c?void 0:c.catchAllError)try{return await A(a,e)}catch(a){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:a}}}return await A(a,e)}),{$sessionSignal:q,session:r}={session:((a,b,c,d)=>{let e=V({data:null,error:null,isPending:!0,isRefetching:!1,refetch:a=>f(a)}),f=a=>{let f="function"==typeof d?d({data:e.get().data,error:e.get().error,isPending:e.get().isPending}):d;c(b,{...f,query:{...f?.query,...a?.query},async onSuccess(a){e.set({data:a.data,error:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch}),await f?.onSuccess?.(a)},async onError(a){let{request:b}=a,c="number"==typeof b.retry?b.retry:b.retry?.attempts,d=b.retryAttempt||0;c&&d<c||(e.set({error:a.error,data:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch}),await f?.onError?.(a))},async onRequest(a){let b=e.get();e.set({isPending:null===b.data,data:b.data,error:null,isRefetching:!0,refetch:e.value.refetch}),await f?.onRequest?.(a)}}).catch(a=>{e.set({error:a,data:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch})})};for(let b of a=Array.isArray(a)?a:[a])b.subscribe(()=>{});return e})(d=V(!1),"/get-session",p,{method:"GET"}),$sessionSignal:d},s=a?.plugins||[],t={},u={$sessionSignal:q,session:r},v={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},w=[{signal:"$sessionSignal",matcher:a=>"/sign-out"===a||"/update-user"===a||a.startsWith("/sign-in")||a.startsWith("/sign-up")||"/delete-user"===a||"/verify-email"===a}];for(let a of s)a.getAtoms&&Object.assign(u,a.getAtoms?.(p)),a.pathMethods&&Object.assign(v,a.pathMethods),a.atomListeners&&w.push(...a.atomListeners);let x={notify:a=>{u[a].set(!u[a].get())},listen:(a,b)=>{u[a].subscribe(b)},atoms:u};for(let b of s)b.getActions&&Object.assign(t,b.getActions?.(p,x,a));return{get baseURL(){return f},pluginsActions:t,pluginsAtoms:u,pluginPathMethods:v,atomListeners:w,$fetch:p,$store:x}})(a),k={};for(let[a,b]of Object.entries(g)){k[`use${(c=a).charAt(0).toUpperCase()+c.slice(1)}`]=()=>(function(a,b={}){let c=(0,e.useRef)(a.get()),{keys:d,deps:f=[a,d]}=b,g=(0,e.useCallback)(b=>{let e=a=>{c.current!==a&&(c.current=a,b())};if(e(a.value),d?.length){let b;return b=new Set(d).add(void 0),a.listen((a,c,d)=>{b.has(d)&&e(a,c,d)})}return a.listen(e)},f),h=()=>c.current;return(0,e.useSyncExternalStore)(g,h,h)})(b)}return b={...f,...k,$fetch:h,$store:i},function a(c=[]){return new Proxy(function(){},{get(d,e){var f;if("string"!=typeof e||"then"===e||"catch"===e||"finally"===e)return;let g=[...c,e],h=b;for(let a of g)if(h&&"object"==typeof h&&a in h)h=h[a];else{h=void 0;break}return"function"==typeof h?h:"object"==typeof(f=h)&&null!==f&&"get"in f&&"function"==typeof f.get&&"lc"in f&&"number"==typeof f.lc?h:a(g)},apply:async(a,b,e)=>{let f="/"+c.map(a=>a.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)).join("/"),i=e[0]||{},k=e[1]||{},{query:l,fetchOptions:m,...n}=i,o={...k,...m},p=function(a,b,c){let d=b[a],{fetchOptions:e,query:f,...g}=c||{};return d||(e?.method?e.method:g&&Object.keys(g).length>0?"POST":"GET")}(f,d,i);return await h(f,{...o,body:"GET"===p?void 0:{...n,...o?.body||{}},query:l||o?.query,method:p,async onSuccess(a){if(await o?.onSuccess?.(a),!j)return;let b=j.filter(a=>a.matcher(f));if(b.length)for(let a of b){let b=g[a.signal];if(!b)return;let c=b.get();setTimeout(()=>{b.set(!c)},10)}}})}})}()}({baseURL:"http://localhost:3000"});function aa(){let[a,b]=(0,e.useState)(null),[c,d]=(0,e.useState)(!0);return(0,e.useEffect)(()=>{let a=async()=>{try{let a=await _.getSession(),c=a&&"object"==typeof a&&"data"in a?a.data:a;b(c),d(!1)}catch(a){console.error("[Better Auth Client] Session error:",a),b(null),d(!1)}};a();let c=setTimeout(a,1e3),e=()=>{document.hidden||a()};return document.addEventListener("visibilitychange",e),()=>{clearTimeout(c),document.removeEventListener("visibilitychange",e)}},[]),{user:a?.user?{userId:a.user.id||"",username:a.user.name||a.user.email||"",email:a.user.email}:null,isLoading:c,isAuthenticated:!!a?.user,session:a}}async function ab(a){await _.signIn.social({provider:"cognito",callbackURL:a||window.location.origin+window.location.pathname})}async function ac(){try{await _.signOut(),window.location.href=window.location.origin}catch(a){console.error("[Better Auth Client] Logout error:",a),window.location.href=window.location.origin}}function ad(){let{user:a,isLoading:b}=aa();return(0,d.jsxs)("header",{children:[(0,d.jsx)("h1",{children:"Scenario Editor"}),(0,d.jsx)("div",{className:"auth-status",children:b?(0,d.jsx)("span",{children:"Checking..."}):a?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("span",{children:["Logged in as ",a.email||a.username]}),(0,d.jsx)("button",{className:"btn btn-secondary",onClick:function(){ac()},children:"Logout"})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{children:"Not logged in"}),(0,d.jsx)("button",{className:"btn btn-primary",onClick:function(){ab(window.location.href)},children:"Login"})]})})]})}let ae={clear:"#e8e8e8",mountain:"#8b7355",forest:"#2d5016",water:"#4a90e2",desert:"#f4a460",swamp:"#556b2f"};function af({columns:a,rows:b,hexes:c=[],selectedTerrain:f="clear",onHexClick:g}){let h=(0,e.useRef)(null),[i,j]=(0,e.useState)(null);return((0,e.useEffect)(()=>{if(!h.current||0===a||0===b)return;let d=h.current;d.innerHTML="";let e=new Map;c.forEach(a=>{let b=`${a.row},${a.column}`;e.set(b,a)});let f=40*Math.sqrt(3),k=a*f*.75+.375*f,l=80*b*.75;d.setAttribute("viewBox",`0 0 ${k} ${l}`);for(let c=0;c<b;c++)for(let b=0;b<a;b++){let a=`${c},${b}`,h=e.get(a)||{row:c,column:b,terrain:"clear"},k=b*f*.75+(c%2==1?.375*f:0),l=80*c*.75,m=document.createElementNS("http://www.w3.org/2000/svg","g");m.setAttribute("class","hex-group"),m.setAttribute("data-row",c.toString()),m.setAttribute("data-column",b.toString());let n=[];for(let a=0;a<6;a++){let b=Math.PI/3*a,c=k+40+40*Math.cos(b),d=l+40+40*Math.sin(b);n.push(`${c},${d}`)}let o=document.createElementNS("http://www.w3.org/2000/svg","polygon");o.setAttribute("points",n.join(" ")),o.setAttribute("fill",ae[h.terrain]||ae.clear),o.setAttribute("stroke","#333"),o.setAttribute("stroke-width","1"),o.setAttribute("class","hex-polygon"),o.style.cursor="pointer",o.addEventListener("mouseenter",()=>{o.setAttribute("stroke-width","2"),o.setAttribute("stroke","#3498db")}),o.addEventListener("mouseleave",()=>{o.setAttribute("stroke-width","1"),o.setAttribute("stroke","#333")}),o.addEventListener("click",()=>{j({row:c,column:b}),g&&g(c,b)}),i&&i.row===c&&i.column===b&&(o.setAttribute("stroke-width","3"),o.setAttribute("stroke","#e74c3c")),m.appendChild(o),d.appendChild(m)}},[a,b,c,f,i,g]),0===a||0===b)?(0,d.jsx)("div",{className:"hex-grid-container",children:(0,d.jsx)("p",{className:"info-message",children:"Set columns and rows to create a grid"})}):(0,d.jsx)("div",{className:"hex-grid-container",children:(0,d.jsx)("svg",{ref:h,className:"hex-grid-svg",preserveAspectRatio:"xMidYMid meet"})})}async function ag(){try{let a=await fetch("/api/auth/get-session",{credentials:"include",cache:"no-store"});if(a.ok){let b=await a.json(),c=b?.data||b;return c?.session?.idToken||c?.idToken||null}return null}catch(a){return console.error("[API Client] Error getting access token:",a),null}}async function ah(a,b,c,d){let e,f=`https://dev.api.syniad.net${b}`,g={};c&&(g["Content-Type"]="application/json");let h=d||await ag();h&&(g.Authorization=`Bearer ${h}`);let i={method:a,headers:g,credentials:"include",cache:"no-store"};c&&(i.body=JSON.stringify(c));try{e=await fetch(f,i)}catch(a){throw console.error("[API Client] Fetch error:",a),Error(`Network error: ${a.message||"Failed to fetch"}`)}if(!e.ok){let a=await e.json().catch(()=>({error:"Unknown error"}));throw console.error("[API Client] API error:",{status:e.status,statusText:e.statusText,error:a,url:f,hasToken:!!h}),Error(a.error||`API request failed: ${e.status} ${e.statusText}`)}return await e.json()}async function ai(a=100,b,c){let d=`/scenarios?limit=${a}`;return b&&(d+=`&nextToken=${encodeURIComponent(b)}`),await ah("GET",d,void 0,c)}async function aj(a,b){return await ah("GET",`/scenarios/${a}`,void 0,b)}async function ak(a,b){return await ah("POST","/scenarios",a,b)}async function al(a,b,c){return await ah("PUT",`/scenarios/${a}`,b,c)}async function am(a,b){return await ah("DELETE",`/scenarios/${a}`,void 0,b)}let an=["clear","mountain","forest","water","desert","swamp"];function ao(){let{isAuthenticated:a}=aa(),[b,c]=(0,e.useState)([]),[f,g]=(0,e.useState)(null),[h,i]=(0,e.useState)("clear"),[j,k]=(0,e.useState)(!1),[l,m]=(0,e.useState)(null),[n,o]=(0,e.useState)(""),[p,q]=(0,e.useState)(""),[r,s]=(0,e.useState)(12),[t,u]=(0,e.useState)(10),[v,w]=(0,e.useState)(15),[x,y]=(0,e.useState)(!1),[z,A]=(0,e.useState)([]);function B(a,b){m({text:a,type:b}),setTimeout(()=>m(null),5e3)}async function C(){if(!a)return void B("Please login to view scenarios","error");try{k(!0);let a=await ai();c(a.scenarios||[])}catch(a){B(`Error loading scenarios: ${a.message}`,"error")}finally{k(!1)}}async function D(b){if(!a)return void B("Please login to load scenarios","error");try{k(!0);let a=(await aj(b)).scenario;g(a),o(a.title),q(a.description),s(a.columns),u(a.rows),w(a.turns),A(a.hexes||[]),y(!0),B("Scenario loaded","success")}catch(a){B(`Error loading scenario: ${a.message}`,"error")}finally{k(!1)}}function E(){g(null),o(""),q(""),s(12),u(10),w(15),A([]),y(!1)}async function F(){if(!a)return void B("Please login to save scenarios","error");if(!n.trim())return void B("Please enter a title","error");try{k(!0);let a={title:n.trim(),description:p.trim(),columns:r,rows:t,turns:v,hexes:z};if(f)await al(f.scenarioId,a),B("Scenario updated successfully","success"),await C();else{let b=await ak(a);g(b.scenario),y(!0),B("Scenario created successfully","success"),await C()}}catch(a){B(`Error saving scenario: ${a.message}`,"error")}finally{k(!1)}}async function G(){if(f&&confirm("Are you sure you want to delete this scenario?")){if(!a)return void B("Please login to delete scenarios","error");try{k(!0),await am(f.scenarioId),B("Scenario deleted successfully","success"),E(),await C()}catch(a){B(`Error deleting scenario: ${a.message}`,"error")}finally{k(!1)}}}return(0,e.useEffect)(()=>{a&&C()},[a]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ad,{}),(0,d.jsxs)("div",{className:"container",children:[(0,d.jsxs)("aside",{className:"sidebar",children:[(0,d.jsxs)("section",{className:"scenario-list-section",children:[(0,d.jsx)("h2",{children:"Scenarios"}),(0,d.jsx)("button",{className:"btn btn-small",onClick:C,children:"Refresh"}),(0,d.jsx)("div",{className:"scenario-list",children:j?(0,d.jsx)("p",{className:"loading",children:"Loading scenarios..."}):0===b.length?(0,d.jsx)("p",{className:"empty-message",children:"No scenarios found"}):b.map(a=>(0,d.jsxs)("div",{className:"scenario-item",children:[(0,d.jsx)("h3",{children:a.title}),(0,d.jsxs)("p",{children:[a.columns,"Ã—",a.rows,", ",a.turns," turns"]}),(0,d.jsx)("button",{className:"btn btn-small",onClick:()=>D(a.scenarioId),children:"Load"})]},a.scenarioId))})]}),(0,d.jsxs)("section",{className:"scenario-form-section",children:[(0,d.jsx)("h2",{children:x?"Edit Scenario":"Create New Scenario"}),(0,d.jsxs)("form",{children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"scenario-title",children:"Title"}),(0,d.jsx)("input",{type:"text",id:"scenario-title",value:n,onChange:a=>o(a.target.value),required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"scenario-description",children:"Description"}),(0,d.jsx)("textarea",{id:"scenario-description",value:p,onChange:a=>q(a.target.value),rows:3})]}),(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"scenario-columns",children:"Columns"}),(0,d.jsx)("input",{type:"number",id:"scenario-columns",value:r,onChange:a=>s(parseInt(a.target.value)||12),min:1,disabled:x,required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"scenario-rows",children:"Rows"}),(0,d.jsx)("input",{type:"number",id:"scenario-rows",value:t,onChange:a=>u(parseInt(a.target.value)||10),min:1,disabled:x,required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{htmlFor:"scenario-turns",children:"Turns"}),(0,d.jsx)("input",{type:"number",id:"scenario-turns",value:v,onChange:a=>w(parseInt(a.target.value)||15),min:1,disabled:x,required:!0})]})]}),(0,d.jsx)("div",{className:"form-actions",children:x?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{type:"button",className:"btn btn-success",onClick:F,children:"Save Changes"}),(0,d.jsx)("button",{type:"button",className:"btn btn-danger",onClick:G,children:"Delete"}),(0,d.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:E,children:"Cancel"})]}):(0,d.jsx)("button",{type:"button",className:"btn btn-primary",onClick:E,children:"Create New"})})]})]}),(0,d.jsxs)("section",{className:"terrain-selector-section",children:[(0,d.jsx)("h2",{children:"Terrain Type"}),(0,d.jsx)("div",{className:"terrain-selector",children:an.map(a=>(0,d.jsx)("button",{className:`terrain-btn ${h===a?"active":""}`,onClick:()=>i(a),title:a.charAt(0).toUpperCase()+a.slice(1),children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),(0,d.jsxs)("p",{className:"selected-terrain",children:["Selected: ",(0,d.jsx)("span",{children:h})]})]})]}),(0,d.jsx)("main",{className:"main-content",children:(0,d.jsx)(af,{columns:r,rows:t,hexes:z,selectedTerrain:h,onHexClick:function(a,b){if(!x&&!f)return;let c=z.findIndex(c=>c.row===a&&c.column===b),d={row:a,column:b,terrain:h};if(c>=0){let a=[...z];a[c]=d,A(a)}else A([...z,d])}})})]}),j&&(0,d.jsxs)("div",{className:"loading-overlay",children:[(0,d.jsx)("div",{className:"loading-spinner"}),(0,d.jsx)("p",{children:"Loading..."})]}),l&&(0,d.jsx)("div",{className:"message-container",children:(0,d.jsx)("div",{className:`message message-${l.type}`,children:l.text})})]})}a.s(["default",()=>ao],49619)}];

//# sourceMappingURL=frontend_scenario-editor_app_page_tsx_2ab5b427._.js.map